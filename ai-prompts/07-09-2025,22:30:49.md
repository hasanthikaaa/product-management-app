PROMPT: 
export dynamodb data code example for nodejs with express

RESPONSE:

Sure! I can give you a clear example of exporting DynamoDB data in a **Node.js + Express** app. Typically, you’d fetch the data from DynamoDB and send it as JSON or CSV to the client. Here’s a simple example using **AWS SDK v3**:

---

### 1️⃣ Setup

```bash
npm install express @aws-sdk/client-dynamodb @aws-sdk/lib-dynamodb
```

---

### 2️⃣ Express App Example

```ts
import express from "express";
import { DynamoDBClient } from "@aws-sdk/client-dynamodb";
import { DynamoDBDocumentClient, ScanCommand } from "@aws-sdk/lib-dynamodb";

const app = express();
const port = 3000;

// Configure AWS DynamoDB Client
const client = new DynamoDBClient({ region: "us-east-1" });
const ddbDocClient = DynamoDBDocumentClient.from(client);

app.get("/export", async (req, res) => {
  try {
    const params = {
      TableName: "YourTableName",
    };

    // Scan DynamoDB table (for small datasets)
    const data = await ddbDocClient.send(new ScanCommand(params));

    // Optional: export as JSON
    res.setHeader("Content-Disposition", "attachment; filename=data.json");
    res.setHeader("Content-Type", "application/json");
    res.send(JSON.stringify(data.Items, null, 2));

    // Optional: export as CSV
    // Uncomment below to export CSV
    /*
    const items = data.Items;
    const csv = items.map(item => Object.values(item).join(",")).join("\n");
    res.setHeader("Content-Disposition", "attachment; filename=data.csv");
    res.setHeader("Content-Type", "text/csv");
    res.send(csv);
    */
  } catch (err) {
    console.error(err);
    res.status(500).send({ error: "Failed to export data" });
  }
});

app.listen(port, () => {
  console.log(`Server running on http://localhost:${port}`);
});
```

---

### ⚠️ Notes:

1. **Scan vs Query**:

    * `Scan` reads the whole table, good for small datasets.
    * For large tables, consider `Query` with pagination or exporting in chunks to avoid memory issues.
2. **CSV Export**:

    * You can customize the CSV headers by mapping keys manually instead of using `Object.values`.
3. **AWS Credentials**:

    * Make sure your environment has `AWS_ACCESS_KEY_ID` and `AWS_SECRET_ACCESS_KEY` set, or you are using an IAM role if running on EC2/Lambda.

---

If you want, I can also provide a **version that streams large DynamoDB tables directly to CSV**, so you don’t load everything into memory at once. This is super useful for production exports.

Do you want me to show that version too?
