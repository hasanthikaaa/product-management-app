PROMPT: Dynamodb put, delete, update, query code examples

RESPONSE: 

Got it üëç You want **AWS DynamoDB code examples (Put, Delete, Update, Query)** in a **Node.js + TypeScript** style. I‚Äôll give you examples using the **AWS SDK v3** (`@aws-sdk/client-dynamodb` and `@aws-sdk/lib-dynamodb`) since it‚Äôs the latest and recommended.

---

# üì¶ Setup

Install dependencies:

```bash
npm install @aws-sdk/client-dynamodb @aws-sdk/lib-dynamodb
```

Create a file `dynamoClient.ts`:

```ts
import { DynamoDBClient } from "@aws-sdk/client-dynamodb";
import { DynamoDBDocumentClient } from "@aws-sdk/lib-dynamodb";

const client = new DynamoDBClient({ region: "us-east-1" });

export const ddbDocClient = DynamoDBDocumentClient.from(client, {
  marshallOptions: {
    removeUndefinedValues: true,
  },
});
```

---

# 1Ô∏è‚É£ Put Item

```ts
import { PutCommand } from "@aws-sdk/lib-dynamodb";
import { ddbDocClient } from "./dynamoClient";

export const putProduct = async () => {
  const params = {
    TableName: "Products",
    Item: {
      productId: "p123",
      sellerId: "s1",
      name: "Laptop",
      description: "High performance laptop",
      quantity: 10,
      price: 1200,
      categoryId: "electronics",
      createdAt: new Date().toISOString(),
      updatedAt: new Date().toISOString(),
    },
  };

  try {
    await ddbDocClient.send(new PutCommand(params));
    console.log("‚úÖ Product inserted");
  } catch (err) {
    console.error("‚ùå Error inserting product:", err);
  }
};
```

---

# 2Ô∏è‚É£ Delete Item

```ts
import { DeleteCommand } from "@aws-sdk/lib-dynamodb";
import { ddbDocClient } from "./dynamoClient";

export const deleteProduct = async () => {
  const params = {
    TableName: "Products",
    Key: {
      productId: "p123",  // Partition key
      sellerId: "s1",     // Sort key (if your table uses one)
    },
  };

  try {
    await ddbDocClient.send(new DeleteCommand(params));
    console.log("‚úÖ Product deleted");
  } catch (err) {
    console.error("‚ùå Error deleting product:", err);
  }
};
```

---

# 3Ô∏è‚É£ Update Item

```ts
import { UpdateCommand } from "@aws-sdk/lib-dynamodb";
import { ddbDocClient } from "./dynamoClient";

export const updateProduct = async () => {
  const params = {
    TableName: "Products",
    Key: {
      productId: "p123",
      sellerId: "s1",
    },
    UpdateExpression: "set quantity = :q, updatedAt = :u",
    ExpressionAttributeValues: {
      ":q": 5,
      ":u": new Date().toISOString(),
    },
    ReturnValues: "ALL_NEW", // returns updated item
  };

  try {
    const result = await ddbDocClient.send(new UpdateCommand(params));
    console.log("‚úÖ Product updated:", result.Attributes);
  } catch (err) {
    console.error("‚ùå Error updating product:", err);
  }
};
```

---

# 4Ô∏è‚É£ Query Items (e.g., Get all products by sellerId)

```ts
import { QueryCommand } from "@aws-sdk/lib-dynamodb";
import { ddbDocClient } from "./dynamoClient";

export const queryProductsBySeller = async () => {
  const params = {
    TableName: "Products",
    KeyConditionExpression: "sellerId = :sid",
    ExpressionAttributeValues: {
      ":sid": "s1",
    },
  };

  try {
    const result = await ddbDocClient.send(new QueryCommand(params));
    console.log("‚úÖ Products found:", result.Items);
  } catch (err) {
    console.error("‚ùå Error querying products:", err);
  }
};
```

---

# üìå Notes

* Make sure your **DynamoDB table schema** matches (e.g., `sellerId` as partition key, `productId` as sort key).
* If your schema is different (like `productId` only as partition key), adjust the keys in `Put`, `Delete`, `Update`, `Query`.
* Use **GSI (Global Secondary Index)** if you want to query by `sellerId` but your table is keyed by `productId`.

---

Would you like me to also sketch a **table design for your Product Management System** (with `productId`, `sellerId`, and maybe GSI on `categoryId`) so queries like *‚Äúget products by seller‚Äù* fit nicely?
